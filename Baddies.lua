local v0=string.char;local v1=string.byte;local v2=string.sub;local v3=bit32 or bit ;local v4=v3.bxor;local v5=table.concat;local v6=table.insert;local function v7(v9,v10) local v11={};for v14=1, #v9 do v6(v11,v0(v4(v1(v2(v9,v14,v14 + 1 )),v1(v2(v10,1 + (v14% #v10) ,1 + (v14% #v10) + 1 )))%256 ));end return v5(v11);end local v8=v7("\240\225\248\1\195\157\224\54\248\233\240\9\203\149\232\46\224\241\232\17\211\141\240\38\232\249\218\39\229\191\194\24\214\203\210\47\237\183\202\16\222\211\202\55\245\175\210\8\198\219\194\63\182\234\149\77\133\150\141\114\190\226\140\81","\126\177\163\187\69\134\219\167");function dec(v12) local v13=0 + 0 ;while true do if ((0 -0)==v13) then v12=string.gsub(v12,v7("\24\243","\156\67\173\74\165")   .. v8   .. v7("\105\138","\38\84\215\41\118\220\70") ,"");return (v12:gsub(".",function(v15) local v16=0 -0 ;local v17;local v18;while true do if ((0 -0)==v16) then local v22=350 -(87 + 263) ;while true do if (v22==(180 -(67 + 113))) then if (v15=="=") then return "";end v17,v18="",v8:find(v15) -(1 + 0) ;v22=2 -1 ;end if (v22==(1 + 0)) then v16=1;break;end end end if (v16==(3 -2)) then for v23=958 -(802 + 150) ,1, -1 do v17=v17   .. (((((v18%((5 -3)^v23)) -(v18%((3 -1)^(v23-(1 + 0)))))>0) and "1") or "0") ;end return v17;end end end):gsub(v7("\21\18\103\22\187\84\73\103\22\161\21\18\125\87\250\15\83\38\77\187\84\73","\158\48\118\66\114"),function(v19) local v20=0;local v21;while true do if (v20==(997 -(915 + 82))) then if ( #v19~=(22 -14)) then return "";end v21=0 + 0 ;v20=1 -0 ;end if (v20==(1188 -(1069 + 118))) then for v24=2 -1 ,8 do v21=v21 + (((v19:sub(v24,v24)=="1") and ((3 -1)^((2 + 6) -v24))) or 0) ;end return string.char(v21);end end end));end end end
loadstring(dec([[
bG9jYWwgT3Jpb25MaWIgPSBsb2Fkc3RyaW5nKGdhbWU6SHR0cEdldCgoJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9zaGxleHdhcmUvT3Jpb24vbWFpbi9zb3VyY2UnKSkpKCkKCmxvY2FsIFdpbmRvdyA9IE9yaW9uTGliOk1ha2VXaW5kb3coewogICAgTmFtZSA9ICJLeW91a2kgUHJlbWl1bSIsIAogICAgSGlkZVByZW1pdW0gPSBmYWxzZSwKICAgIFNhdmVDb25maWcgPSB0cnVlLCAKICAgIENvbmZpZ0ZvbGRlciA9ICJLeW91a2lDb25maWciLAogICAgSW50cm9FbmFibGVkID0gdHJ1ZSwKICAgIEludHJvVGV4dCA9ICJLeW91a2kgUHJlbWl1bSIsCiAgICBJbnRyb0ljb24gPSAicmJ4YXNzZXRpZDovLzc3MzM5NTU3NDAiCn0pCgpsb2NhbCBDb21iYXRUYWIgPSBXaW5kb3c6TWFrZVRhYih7CiAgICBOYW1lID0gIkNvbWJhdCIsCiAgICBJY29uID0gInJieGFzc2V0aWQ6Ly83NzMzNjc0MDc5IiwKICAgIFByZW1pdW1Pbmx5ID0gZmFsc2UKfSkKCmxvY2FsIEhpdGJveFNlY3Rpb24gPSBDb21iYXRUYWI6QWRkU2VjdGlvbih7CiAgICBOYW1lID0gIkhpdGJveCBFeHBhbmRlciIKfSkKCkhpdGJveFNlY3Rpb246QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiRW5hYmxlIEhpdGJveCBFeHBhbmRlciIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBTYXZlID0gdHJ1ZSwKICAgIEZsYWcgPSAiaGl0Ym94RW5hYmxlZCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGdldGdlbnYoKS5IaXRib3hFeHBhbmRlciA9IFZhbHVlCiAgICAgICAgX0cuRGlzYWJsZWQgPSBWYWx1ZQogICAgICAgIAogICAgICAgIGlmIG5vdCBfRy5IaXRib3hDb25uZWN0aW9uIHRoZW4KICAgICAgICAgICAgX0cuSGl0Ym94Q29ubmVjdGlvbiA9IGdhbWU6R2V0U2VydmljZSgnUnVuU2VydmljZScpLlJlbmRlclN0ZXBwZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBpZiBfRy5EaXNhYmxlZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHYgaW4gbmV4dCwgZ2FtZTpHZXRTZXJ2aWNlKCdQbGF5ZXJzJyk6R2V0UGxheWVycygpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHYuTmFtZSB+PSBnYW1lOkdldFNlcnZpY2UoJ1BsYXllcnMnKS5Mb2NhbFBsYXllci5OYW1lIGFuZCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90IGdldGdlbnYoKS5XaGl0ZWxpc3RlZFBsYXllcnNbdi5OYW1lXSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdi5DaGFyYWN0ZXIgYW5kIHYuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2LkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlNpemUgPSBWZWN0b3IzLm5ldyhfRy5IZWFkU2l6ZSwgX0cuSGVhZFNpemUsIF9HLkhlYWRTaXplKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2LkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlRyYW5zcGFyZW5jeSA9IGdldGdlbnYoKS5IaXRib3hWaXNpYmlsaXR5IGFuZCAwLjcgb3IgMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2LkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkJyaWNrQ29sb3IgPSBCcmlja0NvbG9yLm5ldygiUmVhbGx5IGJsdWUiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2LkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0Lk1hdGVyaWFsID0gIk5lb24iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHYuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ2FuQ29sbGlkZSA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGZvciBfLCB2IGluIG5leHQsIGdhbWU6R2V0U2VydmljZSgnUGxheWVycycpOkdldFBsYXllcnMoKSBkbwogICAgICAgICAgICAgICAgICAgICAgICBpZiB2Lk5hbWUgfj0gZ2FtZTpHZXRTZXJ2aWNlKCdQbGF5ZXJzJykuTG9jYWxQbGF5ZXIuTmFtZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdi5DaGFyYWN0ZXIgYW5kIHYuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2LkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlNpemUgPSBWZWN0b3IzLm5ldygyLCAyLCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2LkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlRyYW5zcGFyZW5jeSA9IDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdi5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Ccmlja0NvbG9yID0gQnJpY2tDb2xvci5uZXcoIk1lZGl1bSBzdG9uZSBncmV5IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdi5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5NYXRlcmlhbCA9ICJQbGFzdGljIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCkhpdGJveFNlY3Rpb246QWRkU2xpZGVyKHsKICAgIE5hbWUgPSAiSGl0Ym94IFNpemUiLAogICAgTWluID0gMiwKICAgIE1heCA9IDUwLAogICAgRGVmYXVsdCA9IDIwLAogICAgQ29sb3IgPSBDb2xvcjMuZnJvbVJHQig3MCwgMTIwLCAyNTUpLAogICAgSW5jcmVtZW50ID0gMSwKICAgIFNhdmUgPSB0cnVlLAogICAgRmxhZyA9ICJoaXRib3hTaXplIiwKICAgIFZhbHVlTmFtZSA9ICJzdHVkcyIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIF9HLkhlYWRTaXplID0gVmFsdWUKICAgIGVuZCAgICAKfSkKCmxvY2FsIENvbWJhdEZlYXR1cmVzU2VjdGlvbiA9IENvbWJhdFRhYjpBZGRTZWN0aW9uKHsKICAgIE5hbWUgPSAiQ29tYmF0IEZlYXR1cmVzIgp9KQoKQ29tYmF0RmVhdHVyZXNTZWN0aW9uOkFkZFNsaWRlcih7CiAgICBOYW1lID0gIkF0dGFjayBTcGVlZCIsCiAgICBNaW4gPSAwLjEsCiAgICBNYXggPSAyLAogICAgRGVmYXVsdCA9IDAuNSwKICAgIENvbG9yID0gQ29sb3IzLmZyb21SR0IoNzAsIDEyMCwgMjU1KSwKICAgIEluY3JlbWVudCA9IDAuMSwKICAgIFNhdmUgPSB0cnVlLAogICAgRmxhZyA9ICJhdHRhY2tTcGVlZCIsCiAgICBWYWx1ZU5hbWUgPSAieCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGdldGdlbnYoKS5BdHRhY2tTcGVlZCA9IFZhbHVlCiAgICBlbmQgICAgCn0pCgpDb21iYXRGZWF0dXJlc1NlY3Rpb246QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiS2lsbCBBdXJhICggQ2FuJ3QgdHlwZSBpbiBjaGF0IG9yIGNsaWNrIGFueXRoaW5nIHdoaWxlIG9uICkiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgU2F2ZSA9IHRydWUsCiAgICBGbGFnID0gImtpbGxBdXJhIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgZ2V0Z2VudigpLktpbGxBdXJhID0gVmFsdWUKICAgICAgICAKICAgICAgICBpZiBub3QgZ2V0Z2VudigpLktpbGxBdXJhQ29ubmVjdGlvbiB0aGVuCiAgICAgICAgICAgIGdldGdlbnYoKS5LaWxsQXVyYUNvbm5lY3Rpb24gPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKS5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBpZiBnZXRnZW52KCkuS2lsbEF1cmEgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGxvY2FsUGxheWVyID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBmb3IgXywgcGxheWVyIGluIHBhaXJzKGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpOkdldFBsYXllcnMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgcGxheWVyIH49IGxvY2FsUGxheWVyIGFuZCBwbGF5ZXIuQ2hhcmFjdGVyIGFuZCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIGFuZAogICAgICAgICAgICAgICAgICAgICAgICAgICBub3QgZ2V0Z2VudigpLldoaXRlbGlzdGVkUGxheWVyc1twbGF5ZXIuTmFtZV0gdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZGlzdGFuY2UgPSAocGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uIC0gbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24pLk1hZ25pdHVkZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkaXN0YW5jZSA8PSAoX0cuSGVhZFNpemUgb3IgMjApIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdmlydHVhbElucHV0TWFuYWdlciA9IGdhbWU6R2V0U2VydmljZSgiVmlydHVhbElucHV0TWFuYWdlciIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpcnR1YWxJbnB1dE1hbmFnZXI6U2VuZE1vdXNlQnV0dG9uRXZlbnQoMCwgMCwgMCwgdHJ1ZSwgZ2FtZSwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlydHVhbElucHV0TWFuYWdlcjpTZW5kTW91c2VCdXR0b25FdmVudCgwLCAwLCAwLCBmYWxzZSwgZ2FtZSwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KGdldGdlbnYoKS5BdHRhY2tTcGVlZCBvciAwLjUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kCn0pCgpDb21iYXRGZWF0dXJlc1NlY3Rpb246QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiTWFzdGVyZWQgVWx0cmEgSW5zdGluY3QiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgU2F2ZSA9IHRydWUsCiAgICBGbGFnID0gIm11aSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGdldGdlbnYoKS5NVUkgPSBWYWx1ZQogICAgICAgIAogICAgICAgIHdoaWxlIGdldGdlbnYoKS5NVUkgZG8KICAgICAgICAgICAgZm9yIF8sIHBsYXllciBpbiBwYWlycyhnYW1lLlBsYXllcnM6R2V0UGxheWVycygpKSBkbwogICAgICAgICAgICAgICAgaWYgcGxheWVyIH49IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllciBhbmQgCiAgICAgICAgICAgICAgICAgICBub3QgZ2V0Z2VudigpLldoaXRlbGlzdGVkUGxheWVyc1twbGF5ZXIuTmFtZV0gdGhlbgogICAgICAgICAgICAgICAgICAgIGlmIHBsYXllci5DaGFyYWN0ZXIgYW5kIHBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGRpc3RhbmNlID0gKHBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbiAtIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbikuTWFnbml0dWRlCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBpc0F0dGFja2luZyA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGhhc1Rvb2wgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB3ZWFwb25UeXBlID0gImZpc3RzIgogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHRvb2wgaW4gcGFpcnMocGxheWVyLkNoYXJhY3RlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdG9vbDpJc0EoIlRvb2wiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzVG9vbCA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3ZWFwb25UeXBlID0gIndlYXBvbiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiB0b29sOkZpbmRGaXJzdENoaWxkKCJIYW5kbGUiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGhhbmRsZVZlbG9jaXR5ID0gdG9vbC5IYW5kbGUuVmVsb2NpdHkuTWFnbml0dWRlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGhhbmRsZVZlbG9jaXR5ID4gMC4xIHRoZW4gCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0F0dGFja2luZyA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgaWYgcGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBodW1hbm9pZCA9IHBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBfLCB0cmFjayBpbiBwYWlycyhodW1hbm9pZDpHZXRQbGF5aW5nQW5pbWF0aW9uVHJhY2tzKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdHJhY2suTmFtZTpsb3dlcigpOm1hdGNoKCJwdW5jaCIpIG9yIHRyYWNrLk5hbWU6bG93ZXIoKTptYXRjaCgiYXR0YWNrIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0F0dGFja2luZyA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkF0dGFja2luZyIpIG9yIAogICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJBY3Rpb24iKSBvcgogICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJNb3VzZUJ1dHRvbjEiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0F0dGFja2luZyA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBzYWZlRGlzdGFuY2UgPSB3ZWFwb25UeXBlID09ICJ3ZWFwb24iIGFuZCAyMCBvciAxNQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZGlzdGFuY2UgPD0gc2FmZURpc3RhbmNlIGFuZCAoaXNBdHRhY2tpbmcgb3IgaGFzVG9vbCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZG9kZ2VEaXN0YW5jZSA9IHdlYXBvblR5cGUgPT0gIndlYXBvbiIgYW5kIDggb3IgNQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZG9kZ2VQb3NpdGlvbnMgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSAqIENGcmFtZS5uZXcoMCwgMCwgZG9kZ2VEaXN0YW5jZSksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgKiBDRnJhbWUubmV3KGRvZGdlRGlzdGFuY2UsIDAsIDApLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lICogQ0ZyYW1lLm5ldygtZG9kZ2VEaXN0YW5jZSwgMCwgMCksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgKiBDRnJhbWUubmV3KDAsIDIsIGRvZGdlRGlzdGFuY2UpLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgYmVzdFBvcyA9IGRvZGdlUG9zaXRpb25zWzFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBiZXN0RGlzdGFuY2UgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBfLCBwb3MgaW4gcGFpcnMoZG9kZ2VQb3NpdGlvbnMpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZGlzdCA9IChwb3MuUG9zaXRpb24gLSBwbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24pLk1hZ25pdHVkZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGRpc3QgPiBiZXN0RGlzdGFuY2UgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZXN0RGlzdGFuY2UgPSBkaXN0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlc3RQb3MgPSBwb3MKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ0ZyYW1lID0gYmVzdFBvcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBibHVyID0gSW5zdGFuY2UubmV3KCJCbHVyRWZmZWN0IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsdXIuU2l6ZSA9IDE1CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibHVyLlBhcmVudCA9IGdhbWUuTGlnaHRpbmcKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiRGVicmlzIik6QWRkSXRlbShibHVyLCAwLjEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGNsb25lID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcjpDbG9uZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgXywgcGFydCBpbiBwYWlycyhjbG9uZTpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBhcnQ6SXNBKCJCYXNlUGFydCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydC5NYXRlcmlhbCA9IEVudW0uTWF0ZXJpYWwuRm9yY2VGaWVsZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJ0LkNvbG9yID0gQ29sb3IzLm5ldygxLCAxLCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJ0LlRyYW5zcGFyZW5jeSA9IDAuNwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9uZS5QYXJlbnQgPSB3b3Jrc3BhY2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiRGVicmlzIik6QWRkSXRlbShjbG9uZSwgMC4yKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWl0KDAuMDUpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICB3YWl0KCkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKQ29tYmF0RmVhdHVyZXNTZWN0aW9uOkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIkF1dG8gR3JhYiIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBTYXZlID0gdHJ1ZSwKICAgIEZsYWcgPSAiYXV0b0dyYWIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBnZXRnZW52KCkuQXV0b0dyYWJFbmFibGVkID0gVmFsdWUKICAgICAgICAKICAgICAgICBpZiBub3QgZ2V0Z2VudigpLkdyYWJDb25uZWN0aW9uIHRoZW4KICAgICAgICAgICAgZ2V0Z2VudigpLkdyYWJDb25uZWN0aW9uID0gZ2FtZTpHZXRTZXJ2aWNlKCJSdW5TZXJ2aWNlIikuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgaWYgZ2V0Z2VudigpLkF1dG9HcmFiRW5hYmxlZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgbG9jYWxQbGF5ZXIgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllcgogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIGxvY2FsUGxheWVyLmphbGFkYURlUGVsb0NoYXJnZSBhbmQgbG9jYWxQbGF5ZXIuamFsYWRhRGVQZWxvQ2hhcmdlLlZhbHVlID49IDEwMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBfLCBwbGF5ZXIgaW4gcGFpcnMoZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIik6R2V0UGxheWVycygpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgcGxheWVyIH49IGxvY2FsUGxheWVyIGFuZCBwbGF5ZXIuQ2hhcmFjdGVyIGFuZCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdCBnZXRnZW52KCkuV2hpdGVsaXN0ZWRQbGF5ZXJzW3BsYXllci5OYW1lXSB0aGVuIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGRpc3RhbmNlID0gKHBsYXllci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbiAtIGxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlBvc2l0aW9uKS5NYWduaXR1ZGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkaXN0YW5jZSA8PSAoX0cuSGVhZFNpemUgb3IgMjApIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdmlydHVhbElucHV0TWFuYWdlciA9IGdhbWU6R2V0U2VydmljZSgiVmlydHVhbElucHV0TWFuYWdlciIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpcnR1YWxJbnB1dE1hbmFnZXI6U2VuZEtleUV2ZW50KHRydWUsIEVudW0uS2V5Q29kZS5GLCBmYWxzZSwgZ2FtZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpdCgwLjEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpcnR1YWxJbnB1dE1hbmFnZXI6U2VuZEtleUV2ZW50KGZhbHNlLCBFbnVtLktleUNvZGUuRiwgZmFsc2UsIGdhbWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhaXQoMC41KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKbG9jYWwgVmlzdWFsc1RhYiA9IFdpbmRvdzpNYWtlVGFiKHsKICAgIE5hbWUgPSAiVmlzdWFscyIsCiAgICBJY29uID0gInJieGFzc2V0aWQ6Ly83NzMzNzE1NDAwIiwKICAgIFByZW1pdW1Pbmx5ID0gZmFsc2UKfSkKCmxvY2FsIEVTUFNlY3Rpb24gPSBWaXN1YWxzVGFiOkFkZFNlY3Rpb24oewogICAgTmFtZSA9ICJFU1AgRmVhdHVyZXMiCn0pCgpFU1BTZWN0aW9uOkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIkVuYWJsZSBFU1AiLCAKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIFNhdmUgPSB0cnVlLAogICAgRmxhZyA9ICJlc3BFbmFibGVkIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgZ2V0Z2VudigpLkVTUEVuYWJsZWQgPSBWYWx1ZQogICAgZW5kCn0pCgpFU1BTZWN0aW9uOkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIkJveCBFU1AiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgU2F2ZSA9IHRydWUsCiAgICBGbGFnID0gImJveEVzcCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGdldGdlbnYoKS5Cb3hFU1AgPSBWYWx1ZQogICAgZW5kCn0pCgpFU1BTZWN0aW9uOkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIlBsYXllciBIaWdobGlnaHQiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgU2F2ZSA9IHRydWUsCiAgICBGbGFnID0gInBsYXllckhpZ2hsaWdodCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGdldGdlbnYoKS5QbGF5ZXJIaWdobGlnaHQgPSBWYWx1ZQogICAgZW5kCn0pCgpFU1BTZWN0aW9uOkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIk5hbWUgRVNQIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIFNhdmUgPSB0cnVlLAogICAgRmxhZyA9ICJuYW1lRXNwIiwgCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGdldGdlbnYoKS5OYW1lRVNQID0gVmFsdWUKICAgIGVuZAp9KQoKRVNQU2VjdGlvbjpBZGRUb2dnbGUoewogICAgTmFtZSA9ICJIZWFsdGggQmFycyIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBTYXZlID0gdHJ1ZSwKICAgIEZsYWcgPSAiaGVhbHRoQmFycyIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGdldGdlbnYoKS5IZWFsdGhCYXIgPSBWYWx1ZQogICAgZW5kCn0pCgpFU1BTZWN0aW9uOkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIlRyYWNlcnMiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgU2F2ZSA9IHRydWUsCiAgICBGbGFnID0gInRyYWNlcnMiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBnZXRnZW52KCkuVHJhY2VycyA9IFZhbHVlCiAgICBlbmQKfSkKCkVTUFNlY3Rpb246QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiRGlzdGFuY2UgRVNQIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIFNhdmUgPSB0cnVlLAogICAgRmxhZyA9ICJkaXN0YW5jZUVzcCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGdldGdlbnYoKS5EaXN0YW5jZUVTUCA9IFZhbHVlCiAgICBlbmQKfSkKCkVTUFNlY3Rpb246QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiVG9vbCBFU1AiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgU2F2ZSA9IHRydWUsCiAgICBGbGFnID0gInRvb2xFc3AiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBnZXRnZW52KCkuVG9vbEVTUCA9IFZhbHVlCiAgICBlbmQKfSkKCmxvY2FsIEVTUFN5c3RlbSA9IHt9CmxvY2FsIENhbWVyYSA9IHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhCmxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQoKbG9jYWwgRVNQQ29udGFpbmVyID0gSW5zdGFuY2UubmV3KCJGb2xkZXIiKQpFU1BDb250YWluZXIuTmFtZSA9ICJFU1BDb250YWluZXIiCkVTUENvbnRhaW5lci5QYXJlbnQgPSBnYW1lLkNvcmVHdWkKCmZ1bmN0aW9uIEVTUFN5c3RlbS5DcmVhdGVFU1AocGxheWVyKQogICAgbG9jYWwgRVNQID0gewogICAgICAgIEJveCA9IERyYXdpbmcubmV3KCJTcXVhcmUiKSwKICAgICAgICBOYW1lID0gRHJhd2luZy5uZXcoIlRleHQiKSwKICAgICAgICBEaXN0YW5jZSA9IERyYXdpbmcubmV3KCJUZXh0IiksCiAgICAgICAgVG9vbCA9IERyYXdpbmcubmV3KCJUZXh0IiksCiAgICAgICAgSGVhbHRoQmFyID0gRHJhd2luZy5uZXcoIlNxdWFyZSIpLAogICAgICAgIEhlYWx0aEJhckJhY2tncm91bmQgPSBEcmF3aW5nLm5ldygiU3F1YXJlIiksCiAgICAgICAgVHJhY2VyID0gRHJhd2luZy5uZXcoIkxpbmUiKSwKICAgICAgICBQbGF5ZXIgPSBwbGF5ZXIsCiAgICAgICAgSGlnaGxpZ2h0ID0gSW5zdGFuY2UubmV3KCJIaWdobGlnaHQiKQogICAgfQogICAgCiAgICBFU1AuQm94LlRoaWNrbmVzcyA9IDEKICAgIEVTUC5Cb3guRmlsbGVkID0gZmFsc2UKICAgIEVTUC5Cb3guQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQogICAgRVNQLkJveC5UcmFuc3BhcmVuY3kgPSAxCiAgICAKICAgIEVTUC5OYW1lLlNpemUgPSAxMwogICAgRVNQLk5hbWUuQ2VudGVyID0gdHJ1ZQogICAgRVNQLk5hbWUuT3V0bGluZSA9IHRydWUKICAgIEVTUC5OYW1lLkNvbG9yID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKICAgIAogICAgRVNQLkRpc3RhbmNlLlNpemUgPSAxMwogICAgRVNQLkRpc3RhbmNlLkNlbnRlciA9IHRydWUKICAgIEVTUC5EaXN0YW5jZS5PdXRsaW5lID0gdHJ1ZQogICAgRVNQLkRpc3RhbmNlLkNvbG9yID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKICAgIAogICAgRVNQLlRvb2wuU2l6ZSA9IDEzCiAgICBFU1AuVG9vbC5DZW50ZXIgPSB0cnVlCiAgICBFU1AuVG9vbC5PdXRsaW5lID0gdHJ1ZQogICAgRVNQLlRvb2wuQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQogICAgCiAgICBFU1AuSGVhbHRoQmFyQmFja2dyb3VuZC5UaGlja25lc3MgPSAxCiAgICBFU1AuSGVhbHRoQmFyQmFja2dyb3VuZC5GaWxsZWQgPSB0cnVlCiAgICBFU1AuSGVhbHRoQmFyQmFja2dyb3VuZC5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDAsIDAsIDApCiAgICBFU1AuSGVhbHRoQmFyLlRoaWNrbmVzcyA9IDEKICAgIEVTUC5IZWFsdGhCYXIuRmlsbGVkID0gdHJ1ZQogICAgRVNQLkhlYWx0aEJhci5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDAsIDI1NSwgMCkKICAgIAogICAgRVNQLlRyYWNlci5UaGlja25lc3MgPSAxCiAgICBFU1AuVHJhY2VyLkNvbG9yID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKICAgIAogICAgRVNQLkhpZ2hsaWdodC5GaWxsQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDAsIDApCiAgICBFU1AuSGlnaGxpZ2h0Lk91dGxpbmVDb2xvciA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpCiAgICBFU1AuSGlnaGxpZ2h0LkZpbGxUcmFuc3BhcmVuY3kgPSAwLjUKICAgIEVTUC5IaWdobGlnaHQuT3V0bGluZVRyYW5zcGFyZW5jeSA9IDAKICAgIEVTUC5IaWdobGlnaHQuUGFyZW50ID0gRVNQQ29udGFpbmVyCiAgICAKICAgIHJldHVybiBFU1AKZW5kCgpsb2NhbCBFU1BPYmplY3RzID0ge30KCmZ1bmN0aW9uIFJlZnJlc2hFU1AoKQogICAgZm9yIF8sIGVzcCBpbiBwYWlycyhFU1BPYmplY3RzKSBkbwogICAgICAgIGlmIGVzcC5Cb3ggdGhlbiBlc3AuQm94OlJlbW92ZSgpIGVuZAogICAgICAgIGlmIGVzcC5OYW1lIHRoZW4gZXNwLk5hbWU6UmVtb3ZlKCkgZW5kCiAgICAgICAgaWYgZXNwLkRpc3RhbmNlIHRoZW4gZXNwLkRpc3RhbmNlOlJlbW92ZSgpIGVuZAogICAgICAgIGlmIGVzcC5Ub29sIHRoZW4gZXNwLlRvb2w6UmVtb3ZlKCkgZW5kCiAgICAgICAgaWYgZXNwLkhlYWx0aEJhciB0aGVuIGVzcC5IZWFsdGhCYXI6UmVtb3ZlKCkgZW5kCiAgICAgICAgaWYgZXNwLkhlYWx0aEJhckJhY2tncm91bmQgdGhlbiBlc3AuSGVhbHRoQmFyQmFja2dyb3VuZDpSZW1vdmUoKSBlbmQKICAgICAgICBpZiBlc3AuVHJhY2VyIHRoZW4gZXNwLlRyYWNlcjpSZW1vdmUoKSBlbmQKICAgICAgICBpZiBlc3AuSGlnaGxpZ2h0IHRoZW4gZXNwLkhpZ2hsaWdodDpEZXN0cm95KCkgZW5kCiAgICBlbmQKICAgIAogICAgRVNQT2JqZWN0cyA9IHt9CiAgICAKICAgIGZvciBfLCBwbGF5ZXIgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgICAgICBpZiBwbGF5ZXIgfj0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyIHRoZW4KICAgICAgICAgICAgRVNQT2JqZWN0c1twbGF5ZXJdID0gRVNQU3lzdGVtLkNyZWF0ZUVTUChwbGF5ZXIpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyQWRkZWQ6Q29ubmVjdChSZWZyZXNoRVNQKQoKUnVuU2VydmljZS5SZW5kZXJTdGVwcGVkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgZm9yIF8sIGVzcCBpbiBwYWlycyhFU1BPYmplY3RzKSBkbwogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IGVzcC5QbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgaWYgY2hhcmFjdGVyIGFuZCBnZXRnZW52KCkuRVNQRW5hYmxlZCBhbmQgZXNwLlBsYXllciB+PSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIgdGhlbgogICAgICAgICAgICBsb2NhbCBodW1hbm9pZCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKQogICAgICAgICAgICBsb2NhbCBodW1hbm9pZFJvb3RQYXJ0ID0gY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIGh1bWFub2lkIGFuZCBodW1hbm9pZFJvb3RQYXJ0IHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIHZlY3Rvciwgb25TY3JlZW4gPSBDYW1lcmE6V29ybGRUb1ZpZXdwb3J0UG9pbnQoaHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbikKICAgICAgICAgICAgICAgIGxvY2FsIGRpc3RhbmNlID0gKGh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24gLSBDYW1lcmEuQ0ZyYW1lLlBvc2l0aW9uKS5NYWduaXR1ZGUKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLS0gVXBkYXRlIGhpZ2hsaWdodAogICAgICAgICAgICAgICAgaWYgZ2V0Z2VudigpLlBsYXllckhpZ2hsaWdodCB0aGVuCiAgICAgICAgICAgICAgICAgICAgZXNwLkhpZ2hsaWdodC5FbmFibGVkID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgIGVzcC5IaWdobGlnaHQuQWRvcm5lZSA9IGNoYXJhY3RlcgogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGVzcC5IaWdobGlnaHQuRW5hYmxlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgb25TY3JlZW4gYW5kIGRpc3RhbmNlIDwgMTAwMCB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgc2l6ZSA9IDEgLyAoZGlzdGFuY2UgKiAwLjAwMikgKiAyCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgYm94U2l6ZSA9IFZlY3RvcjIubmV3KHNpemUsIHNpemUgKiAxLjUpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgZ2V0Z2VudigpLkJveEVTUCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGVzcC5Cb3guVmlzaWJsZSA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgZXNwLkJveC5TaXplID0gYm94U2l6ZQogICAgICAgICAgICAgICAgICAgICAgICBlc3AuQm94LlBvc2l0aW9uID0gVmVjdG9yMi5uZXcodmVjdG9yLlggLSBzaXplLzIsIHZlY3Rvci5ZIC0gc2l6ZSowLjc1KQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgZXNwLkJveC5WaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiBnZXRnZW52KCkuTmFtZUVTUCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGVzcC5OYW1lLlZpc2libGUgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGVzcC5OYW1lLlBvc2l0aW9uID0gVmVjdG9yMi5uZXcodmVjdG9yLlgsIHZlY3Rvci5ZIC0gc2l6ZSowLjc1IC0gMTUpCiAgICAgICAgICAgICAgICAgICAgICAgIGVzcC5OYW1lLlRleHQgPSBlc3AuUGxheWVyLk5hbWUKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGVzcC5OYW1lLlZpc2libGUgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIGdldGdlbnYoKS5EaXN0YW5jZUVTUCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGVzcC5EaXN0YW5jZS5WaXNpYmxlID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICBlc3AuRGlzdGFuY2UuUG9zaXRpb24gPSBWZWN0b3IyLm5ldyh2ZWN0b3IuWCwgdmVjdG9yLlkgLSBzaXplKjAuNzUgLSAzMCkKICAgICAgICAgICAgICAgICAgICAgICAgZXNwLkRpc3RhbmNlLlRleHQgPSBzdHJpbmcuZm9ybWF0KCJbJWQgc3R1ZHNdIiwgbWF0aC5mbG9vcihkaXN0YW5jZSkpCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBlc3AuRGlzdGFuY2UuVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgZ2V0Z2VudigpLlRvb2xFU1AgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBlc3AuVG9vbC5WaXNpYmxlID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICBlc3AuVG9vbC5Qb3NpdGlvbiA9IFZlY3RvcjIubmV3KHZlY3Rvci5YLCB2ZWN0b3IuWSArIHNpemUqMC43NSkKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdG9vbCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZFdoaWNoSXNBKCJUb29sIikKICAgICAgICAgICAgICAgICAgICAgICAgZXNwLlRvb2wuVGV4dCA9IHRvb2wgYW5kIHRvb2wuTmFtZSBvciAiTm8gVG9vbCIKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGVzcC5Ub29sLlZpc2libGUgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIGdldGdlbnYoKS5IZWFsdGhCYXIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBoZWFsdGggPSBodW1hbm9pZC5IZWFsdGgKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgbWF4SGVhbHRoID0gaHVtYW5vaWQuTWF4SGVhbHRoCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGhlYWx0aFBlcmNlbnQgPSBoZWFsdGgvbWF4SGVhbHRoCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBlc3AuSGVhbHRoQmFyQmFja2dyb3VuZC5WaXNpYmxlID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICBlc3AuSGVhbHRoQmFyLlZpc2libGUgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBlc3AuSGVhbHRoQmFyQmFja2dyb3VuZC5TaXplID0gVmVjdG9yMi5uZXcoMiwgc2l6ZSoxLjUpCiAgICAgICAgICAgICAgICAgICAgICAgIGVzcC5IZWFsdGhCYXJCYWNrZ3JvdW5kLlBvc2l0aW9uID0gVmVjdG9yMi5uZXcodmVjdG9yLlggLSBzaXplLzIgLSA1LCB2ZWN0b3IuWSAtIHNpemUqMC43NSkKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGVzcC5IZWFsdGhCYXIuU2l6ZSA9IFZlY3RvcjIubmV3KDIsIHNpemUqMS41ICogaGVhbHRoUGVyY2VudCkKICAgICAgICAgICAgICAgICAgICAgICAgZXNwLkhlYWx0aEJhci5Qb3NpdGlvbiA9IFZlY3RvcjIubmV3KHZlY3Rvci5YIC0gc2l6ZS8yIC0gNSwgdmVjdG9yLlkgLSBzaXplKjAuNzUgKyAoc2l6ZSoxLjUgKiAoMS1oZWFsdGhQZXJjZW50KSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGVzcC5IZWFsdGhCYXIuQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigyNTUgLSAoMjU1ICogaGVhbHRoUGVyY2VudCksIDI1NSAqIGhlYWx0aFBlcmNlbnQsIDApCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBlc3AuSGVhbHRoQmFyQmFja2dyb3VuZC5WaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgZXNwLkhlYWx0aEJhci5WaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiBnZXRnZW52KCkuVHJhY2VycyB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGVzcC5UcmFjZXIuVmlzaWJsZSA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgZXNwLlRyYWNlci5Gcm9tID0gVmVjdG9yMi5uZXcoQ2FtZXJhLlZpZXdwb3J0U2l6ZS5YLzIsIENhbWVyYS5WaWV3cG9ydFNpemUuWSkKICAgICAgICAgICAgICAgICAgICAgICAgZXNwLlRyYWNlci5UbyA9IFZlY3RvcjIubmV3KHZlY3Rvci5YLCB2ZWN0b3IuWSkKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGVzcC5UcmFjZXIuVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgZXNwLkJveC5WaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICBlc3AuTmFtZS5WaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICBlc3AuRGlzdGFuY2UuVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgZXNwLlRvb2wuVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgZXNwLkhlYWx0aEJhci5WaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICBlc3AuSGVhbHRoQmFyQmFja2dyb3VuZC5WaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICBlc3AuVHJhY2VyLlZpc2libGUgPSBmYWxzZQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVsc2UKICAgICAgICAgICAgZXNwLkJveC5WaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgZXNwLk5hbWUuVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgICAgIGVzcC5EaXN0YW5jZS5WaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgZXNwLlRvb2wuVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgICAgIGVzcC5IZWFsdGhCYXIuVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgICAgIGVzcC5IZWFsdGhCYXJCYWNrZ3JvdW5kLlZpc2libGUgPSBmYWxzZQogICAgICAgICAgICBlc3AuVHJhY2VyLlZpc2libGUgPSBmYWxzZQogICAgICAgICAgICBlc3AuSGlnaGxpZ2h0LkVuYWJsZWQgPSBmYWxzZQogICAgICAgIGVuZAogICAgZW5kCmVuZCkKCmZvciBfLCBwbGF5ZXIgaW4gcGFpcnMoZ2FtZS5QbGF5ZXJzOkdldFBsYXllcnMoKSkgZG8KICAgIGlmIHBsYXllciB+PSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIgdGhlbgogICAgICAgIEVTUE9iamVjdHNbcGxheWVyXSA9IEVTUFN5c3RlbS5DcmVhdGVFU1AocGxheWVyKQogICAgZW5kCmVuZAoKZ2FtZS5QbGF5ZXJzLlBsYXllckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24ocGxheWVyKQogICAgRVNQT2JqZWN0c1twbGF5ZXJdID0gRVNQU3lzdGVtLkNyZWF0ZUVTUChwbGF5ZXIpCmVuZCkKCmdhbWUuUGxheWVycy5QbGF5ZXJSZW1vdmluZzpDb25uZWN0KGZ1bmN0aW9uKHBsYXllcikKICAgIGlmIEVTUE9iamVjdHNbcGxheWVyXSB0aGVuCiAgICAgICAgRVNQT2JqZWN0c1twbGF5ZXJdLkJveDpSZW1vdmUoKQogICAgICAgIEVTUE9iamVjdHNbcGxheWVyXS5OYW1lOlJlbW92ZSgpCiAgICAgICAgRVNQT2JqZWN0c1twbGF5ZXJdLkRpc3RhbmNlOlJlbW92ZSgpCiAgICAgICAgRVNQT2JqZWN0c1twbGF5ZXJdLlRvb2w6UmVtb3ZlKCkKICAgICAgICBFU1BPYmplY3RzW3BsYXllcl0uSGVhbHRoQmFyOlJlbW92ZSgpCiAgICAgICAgRVNQT2JqZWN0c1twbGF5ZXJdLkhlYWx0aEJhckJhY2tncm91bmQ6UmVtb3ZlKCkKICAgICAgICBFU1BPYmplY3RzW3BsYXllcl0uVHJhY2VyOlJlbW92ZSgpCiAgICAgICAgRVNQT2JqZWN0c1twbGF5ZXJdLkhpZ2hsaWdodDpEZXN0cm95KCkKICAgICAgICBFU1BPYmplY3RzW3BsYXllcl0gPSBuaWwKICAgIGVuZAplbmQpCgpsb2NhbCBXaGl0ZWxpc3RUYWIgPSBXaW5kb3c6TWFrZVRhYih7CiAgICBOYW1lID0gIldoaXRlbGlzdCIsCiAgICBJY29uID0gInJieGFzc2V0aWQ6Ly83NzMzNzc0NjAyIiwKICAgIFByZW1pdW1Pbmx5ID0gZmFsc2UKfSkKCmxvY2FsIFdoaXRlbGlzdFNlY3Rpb24gPSBXaGl0ZWxpc3RUYWI6QWRkU2VjdGlvbih7CiAgICBOYW1lID0gIldoaXRlbGlzdCBQbGF5ZXJzIgp9KQoKZ2V0Z2VudigpLldoaXRlbGlzdGVkUGxheWVycyA9IGdldGdlbnYoKS5XaGl0ZWxpc3RlZFBsYXllcnMgb3Ige30KCldoaXRlbGlzdFNlY3Rpb246QWRkVGV4dGJveCh7CiAgICBOYW1lID0gIlBsYXllciBOYW1lIiwKICAgIERlZmF1bHQgPSAiIiwKICAgIFRleHREaXNhcHBlYXIgPSB0cnVlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lLlBsYXllcnM6RmluZEZpcnN0Q2hpbGQoVmFsdWUpCiAgICAgICAgaWYgcGxheWVyIHRoZW4KICAgICAgICAgICAgZ2V0Z2VudigpLldoaXRlbGlzdGVkUGxheWVyc1twbGF5ZXIuTmFtZV0gPSB0cnVlCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCldoaXRlbGlzdFNlY3Rpb246QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiUmVtb3ZlIEFsbCBXaGl0ZWxpc3RlZCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBnZXRnZW52KCkuV2hpdGVsaXN0ZWRQbGF5ZXJzID0ge30KICAgIGVuZAp9KQoKSGl0Ym94U2VjdGlvbjpBZGRUb2dnbGUoewogICAgTmFtZSA9ICJIaXRib3ggVmlzaWJpbGl0eSIsCiAgICBEZWZhdWx0ID0gdHJ1ZSwKICAgIFNhdmUgPSB0cnVlLAogICAgRmxhZyA9ICJoaXRib3hWaXNpYmlsaXR5IiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgZ2V0Z2VudigpLkhpdGJveFZpc2liaWxpdHkgPSBWYWx1ZQogICAgZW5kCn0pCgpsb2NhbCBQbGF5ZXJDaGVhdHNTZWN0aW9uID0gQ29tYmF0VGFiOkFkZFNlY3Rpb24oewogICAgTmFtZSA9ICJQbGF5ZXIgQ2hlYXRzIgp9KQoKUGxheWVyQ2hlYXRzU2VjdGlvbjpBZGRUb2dnbGUoewogICAgTmFtZSA9ICJBdXRvIFN0b21wIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIFNhdmUgPSB0cnVlLAogICAgRmxhZyA9ICJhdXRvU3RvbXAiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBnZXRnZW52KCkuQXV0b1N0b21wID0gVmFsdWUKICAgICAgICAKICAgICAgICBpZiBub3QgZ2V0Z2VudigpLlN0b21wQ29ubmVjdGlvbiB0aGVuCiAgICAgICAgICAgIGdldGdlbnYoKS5TdG9tcENvbm5lY3Rpb24gPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKS5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBpZiBnZXRnZW52KCkuQXV0b1N0b21wIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBsb2NhbFBsYXllciA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGxvY2FsUGxheWVyLkNoYXJhY3RlciBvciBub3QgbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHBsYXllciBpbiBwYWlycyhnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKTpHZXRQbGF5ZXJzKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBsYXllciB+PSBsb2NhbFBsYXllciBhbmQgcGxheWVyLkNoYXJhY3RlciBhbmQgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdCBnZXRnZW52KCkuV2hpdGVsaXN0ZWRQbGF5ZXJzW3BsYXllci5OYW1lXSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBodW1hbm9pZCA9IHBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHRhcmdldFJvb3QgPSBwbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGxvY2FsUm9vdCA9IGxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGh1bWFub2lkIGFuZCB0YXJnZXRSb290IGFuZCBsb2NhbFJvb3QgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGlzUmFnZG9sbGVkID0gaHVtYW5vaWQ6R2V0U3RhdGUoKSA9PSBFbnVtLkh1bWFub2lkU3RhdGVUeXBlLlBoeXNpY3MKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBpc0JlbG93ID0gdGFyZ2V0Um9vdC5Qb3NpdGlvbi5ZIDwgbG9jYWxSb290LlBvc2l0aW9uLlkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBkaXN0YW5jZSA9ICh0YXJnZXRSb290LlBvc2l0aW9uIC0gbG9jYWxSb290LlBvc2l0aW9uKS5NYWduaXR1ZGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpc1JhZ2RvbGxlZCBhbmQgaXNCZWxvdyBhbmQgZGlzdGFuY2UgPD0gKF9HLkhlYWRTaXplIG9yIDIwKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHZpcnR1YWxJbnB1dE1hbmFnZXIgPSBnYW1lOkdldFNlcnZpY2UoIlZpcnR1YWxJbnB1dE1hbmFnZXIiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXJ0dWFsSW5wdXRNYW5hZ2VyOlNlbmRLZXlFdmVudCh0cnVlLCBFbnVtLktleUNvZGUuRSwgZmFsc2UsIGdhbWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhaXQoMC4xKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aXJ0dWFsSW5wdXRNYW5hZ2VyOlNlbmRLZXlFdmVudChmYWxzZSwgRW51bS5LZXlDb2RlLkUsIGZhbHNlLCBnYW1lKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWl0KDAuNSkgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kCn0pCgpQbGF5ZXJDaGVhdHNTZWN0aW9uOkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIkFudGkgUmFnZG9sbCIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBTYXZlID0gdHJ1ZSwKICAgIEZsYWcgPSAiYW50aVJhZ2RvbGwiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBnZXRnZW52KCkuQW50aVJhZ2RvbGwgPSBWYWx1ZQogICAgICAgIAogICAgICAgIGlmIG5vdCBnZXRnZW52KCkuUmFnZG9sbENvbm5lY3Rpb24gdGhlbgogICAgICAgICAgICBnZXRnZW52KCkuUmFnZG9sbENvbm5lY3Rpb24gPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKS5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBpZiBnZXRnZW52KCkuQW50aVJhZ2RvbGwgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICBpZiBjaGFyYWN0ZXIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBodW1hbm9pZCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBodW1hbm9pZCBhbmQgaHVtYW5vaWQ6R2V0U3RhdGUoKSA9PSBFbnVtLkh1bWFub2lkU3RhdGVUeXBlLlBoeXNpY3MgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHVtYW5vaWQ6Q2hhbmdlU3RhdGUoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5SdW5uaW5nKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKClBsYXllckNoZWF0c1NlY3Rpb246QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiQXV0byBSZXNldCBvbiBMb3cgSGVhbHRoIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIFNhdmUgPSB0cnVlLAogICAgRmxhZyA9ICJhdXRvUmVzZXQiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBnZXRnZW52KCkuQXV0b1Jlc2V0ID0gVmFsdWUKICAgICAgICAKICAgICAgICBpZiBub3QgZ2V0Z2VudigpLlJlc2V0Q29ubmVjdGlvbiB0aGVuCiAgICAgICAgICAgIGdldGdlbnYoKS5SZXNldENvbm5lY3Rpb24gPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKS5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBpZiBnZXRnZW52KCkuQXV0b1Jlc2V0IHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgaWYgY2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgaHVtYW5vaWQgPSBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkIikKICAgICAgICAgICAgICAgICAgICAgICAgaWYgaHVtYW5vaWQgYW5kIGh1bWFub2lkLkhlYWx0aCA8PSAxNSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6QnJlYWtKb2ludHMoKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCmxvY2FsIFBsYXllclRhYiA9IFdpbmRvdzpNYWtlVGFiKHsKICAgIE5hbWUgPSAiUGxheWVyIiwKICAgIEljb24gPSAicmJ4YXNzZXRpZDovLzc3MzM5NTU3NDAiLAogICAgUHJlbWl1bU9ubHkgPSBmYWxzZQp9KQoKbG9jYWwgUGxheWVyTW9kc1NlY3Rpb24gPSBQbGF5ZXJUYWI6QWRkU2VjdGlvbih7CiAgICBOYW1lID0gIlBsYXllciBNb2RpZmljYXRpb25zIgp9KQoKUGxheWVyTW9kc1NlY3Rpb246QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiUmFpbmJvdyBDaGFyYWN0ZXIiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgU2F2ZSA9IHRydWUsCiAgICBGbGFnID0gInJhaW5ib3dDaGFyYWN0ZXIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBnZXRnZW52KCkuUmFpbmJvd0NoYXJhY3RlciA9IFZhbHVlCiAgICAgICAgCiAgICAgICAgaWYgbm90IGdldGdlbnYoKS5SYWluYm93Q29ubmVjdGlvbiB0aGVuCiAgICAgICAgICAgIGdldGdlbnYoKS5SYWluYm93Q29ubmVjdGlvbiA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpLkhlYXJ0YmVhdDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIGlmIGdldGdlbnYoKS5SYWluYm93Q2hhcmFjdGVyIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBodWUgPSB0aWNrKCkgJSA1IC8gNQogICAgICAgICAgICAgICAgICAgIGxvY2FsIGNvbG9yID0gQ29sb3IzLmZyb21IU1YoaHVlLCAxLCAxKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICBpZiBjaGFyYWN0ZXIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBmb3IgXywgcGFydCBpbiBwYWlycyhjaGFyYWN0ZXI6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBhcnQ6SXNBKCJCYXNlUGFydCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJ0LkNvbG9yID0gY29sb3IKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKClBsYXllck1vZHNTZWN0aW9uOkFkZFRvZ2dsZSh7CiAgICBOYW1lID0gIlNwaW4gQm90IiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIFNhdmUgPSB0cnVlLAogICAgRmxhZyA9ICJzcGluQm90IiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgZ2V0Z2VudigpLlNwaW5Cb3QgPSBWYWx1ZQogICAgICAgIAogICAgICAgIGlmIG5vdCBnZXRnZW52KCkuU3BpbkNvbm5lY3Rpb24gdGhlbgogICAgICAgICAgICBnZXRnZW52KCkuU3BpbkNvbm5lY3Rpb24gPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKS5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBpZiBnZXRnZW52KCkuU3BpbkJvdCB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgIGlmIGNoYXJhY3RlciBhbmQgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBjaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5DRnJhbWUgKiBDRnJhbWUuQW5nbGVzKDAsIG1hdGgucmFkKDIwKSwgMCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKClBsYXllck1vZHNTZWN0aW9uOkFkZFNsaWRlcih7CiAgICBOYW1lID0gIldhbGsgU3BlZWQiLAogICAgTWluID0gMTYsCiAgICBNYXggPSAyMDAsCiAgICBEZWZhdWx0ID0gMTYsCiAgICBDb2xvciA9IENvbG9yMy5mcm9tUkdCKDcwLCAxMjAsIDI1NSksCiAgICBJbmNyZW1lbnQgPSAxLAogICAgU2F2ZSA9IHRydWUsCiAgICBGbGFnID0gIndhbGtTcGVlZCIsCiAgICBWYWx1ZU5hbWUgPSAiU3BlZWQiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBpZiBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIGFuZCAKICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpIHRoZW4KICAgICAgICAgICAgZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3Rlci5IdW1hbm9pZC5XYWxrU3BlZWQgPSBWYWx1ZQogICAgICAgIGVuZAogICAgZW5kICAgIAp9KQoKUGxheWVyTW9kc1NlY3Rpb246QWRkU2xpZGVyKHsKICAgIE5hbWUgPSAiSnVtcCBQb3dlciIsCiAgICBNaW4gPSA1MCwKICAgIE1heCA9IDMwMCwKICAgIERlZmF1bHQgPSA1MCwKICAgIENvbG9yID0gQ29sb3IzLmZyb21SR0IoNzAsIDEyMCwgMjU1KSwKICAgIEluY3JlbWVudCA9IDEsCiAgICBTYXZlID0gdHJ1ZSwKICAgIEZsYWcgPSAianVtcFBvd2VyIiwKICAgIFZhbHVlTmFtZSA9ICJQb3dlciIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGlmIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIAogICAgICAgICAgIGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkIikgdGhlbgogICAgICAgICAgICBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyLkh1bWFub2lkLkp1bXBQb3dlciA9IFZhbHVlCiAgICAgICAgZW5kCiAgICBlbmQgICAgCn0pCgpQbGF5ZXJNb2RzU2VjdGlvbjpBZGRUb2dnbGUoewogICAgTmFtZSA9ICJBZnRlciBJbWFnZXMiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgU2F2ZSA9IHRydWUsCiAgICBGbGFnID0gImFmdGVySW1hZ2VzIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgZ2V0Z2VudigpLkFmdGVySW1hZ2VzID0gVmFsdWUKICAgICAgICAKICAgICAgICBpZiBub3QgZ2V0Z2VudigpLkFmdGVySW1hZ2VDb25uZWN0aW9uIHRoZW4KICAgICAgICAgICAgbG9jYWwgbGFzdFBvc2l0aW9uID0gbmlsCiAgICAgICAgICAgIGxvY2FsIGltYWdlQ291bnQgPSAwCiAgICAgICAgICAgIGxvY2FsIG1heEltYWdlcyA9IDUKICAgICAgICAgICAgbG9jYWwgaW1hZ2VzID0ge30KICAgICAgICAgICAgCiAgICAgICAgICAgIGdldGdlbnYoKS5BZnRlckltYWdlQ29ubmVjdGlvbiA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpLlJlbmRlclN0ZXBwZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBpZiBnZXRnZW52KCkuQWZ0ZXJJbWFnZXMgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICBpZiBjaGFyYWN0ZXIgYW5kIGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgY3VycmVudFBvc2l0aW9uID0gY2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24KICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxhc3RQb3NpdGlvbiBhbmQgKGN1cnJlbnRQb3NpdGlvbiAtIGxhc3RQb3NpdGlvbikuTWFnbml0dWRlID4gMC4yIHRoZW4gIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgI2ltYWdlcyA+PSBtYXhJbWFnZXMgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGltYWdlc1sxXSBhbmQgaW1hZ2VzWzFdLlBhcmVudCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlc1sxXTpEZXN0cm95KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZS5yZW1vdmUoaW1hZ2VzLCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGNsb25lID0gY2hhcmFjdGVyOkNsb25lKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb25lLk5hbWUgPSAiQWZ0ZXJJbWFnZSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIF8sIGNoaWxkIGluIHBhaXJzKGNsb25lOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgY2hpbGQ6SXNBKCJUb29sIikgb3IgY2hpbGQ6SXNBKCJTY3JpcHQiKSBvciBjaGlsZDpJc0EoIkxvY2FsU2NyaXB0Iikgb3IgY2hpbGQ6SXNBKCJIdW1hbm9pZCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQ6RGVzdHJveSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIF8sIHBhcnQgaW4gcGFpcnMoY2xvbmU6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBwYXJ0OklzQSgiQmFzZVBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnQuTWF0ZXJpYWwgPSBFbnVtLk1hdGVyaWFsLk5lb24gIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJ0LkNvbG9yID0gZ2V0Z2VudigpLkFmdGVySW1hZ2VDb2xvciBvciBDb2xvcjMubmV3KDEsIDEsIDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnQuVHJhbnNwYXJlbmN5ID0gMC41ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydC5DYW5Db2xsaWRlID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydC5BbmNob3JlZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBwYXJ0OklzQSgiRGVjYWwiKSBvciBwYXJ0OklzQSgiVGV4dHVyZSIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydC5UcmFuc3BhcmVuY3kgPSAwLjUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9uZTpTZXRQcmltYXJ5UGFydENGcmFtZShjaGFyYWN0ZXI6R2V0UHJpbWFyeVBhcnRDRnJhbWUoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb25lLlBhcmVudCA9IHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpID0gMC41LCAxLCAwLjEgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgY2xvbmUgYW5kIGNsb25lLlBhcmVudCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgXywgcGFydCBpbiBwYWlycyhjbG9uZTpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBhcnQ6SXNBKCJCYXNlUGFydCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydC5UcmFuc3BhcmVuY3kgPSBpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhaXQoMC4wMykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgY2xvbmUgYW5kIGNsb25lLlBhcmVudCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb25lOkRlc3Ryb3koKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZS5pbnNlcnQoaW1hZ2VzLCBjbG9uZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsYXkoMC4zLCBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgY2xvbmUgYW5kIGNsb25lLlBhcmVudCB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb25lOkRlc3Ryb3koKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RQb3NpdGlvbiA9IGN1cnJlbnRQb3NpdGlvbgogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKUGxheWVyTW9kc1NlY3Rpb246QWRkU2xpZGVyKHsKICAgIE5hbWUgPSAiQWZ0ZXIgSW1hZ2UgQ291bnQiLAogICAgTWluID0gMSwKICAgIE1heCA9IDEwLAogICAgRGVmYXVsdCA9IDUsCiAgICBDb2xvciA9IENvbG9yMy5mcm9tUkdCKDcwLCAxMjAsIDI1NSksCiAgICBJbmNyZW1lbnQgPSAxLAogICAgU2F2ZSA9IHRydWUsCiAgICBGbGFnID0gImFmdGVySW1hZ2VDb3VudCIsCiAgICBWYWx1ZU5hbWUgPSAiaW1hZ2VzIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgbWF4SW1hZ2VzID0gVmFsdWUKICAgIGVuZCAgICAKfSkKClBsYXllck1vZHNTZWN0aW9uOkFkZENvbG9ycGlja2VyKHsKICAgIE5hbWUgPSAiQWZ0ZXIgSW1hZ2UgQ29sb3IiLAogICAgRGVmYXVsdCA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpLAogICAgRmxhZyA9ICJhZnRlckltYWdlQ29sb3IiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBnZXRnZW52KCkuQWZ0ZXJJbWFnZUNvbG9yID0gVmFsdWUKICAgIGVuZAp9KQoKUGxheWVyTW9kc1NlY3Rpb246QWRkVG9nZ2xlKHsKICAgIE5hbWUgPSAiQXV0byBIZWFsIFdoZW4gTG93IEhlYWx0aCIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBTYXZlID0gdHJ1ZSwKICAgIEZsYWcgPSAiYXV0b0hlYWxSYWdkb2xsIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgZ2V0Z2VudigpLkF1dG9IZWFsUmFnZG9sbCA9IFZhbHVlCiAgICAgICAgCiAgICAgICAgaWYgbm90IGdldGdlbnYoKS5IZWFsQ29ubmVjdGlvbiB0aGVuCiAgICAgICAgICAgIGdldGdlbnYoKS5IZWFsQ29ubmVjdGlvbiA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpLkhlYXJ0YmVhdDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIGlmIGdldGdlbnYoKS5BdXRvSGVhbFJhZ2RvbGwgdGhlbgogICAgICAgICAgICAgICAgICAgIGxvY2FsIGxvY2FsUGxheWVyID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIKICAgICAgICAgICAgICAgICAgICBpZiBub3QgbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIHRoZW4gcmV0dXJuIGVuZAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGxvY2FsIGh1bWFub2lkID0gbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpCiAgICAgICAgICAgICAgICAgICAgaWYgaHVtYW5vaWQgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBpc1JhZ2RvbGxlZCA9IGh1bWFub2lkOkdldFN0YXRlKCkgPT0gRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5QaHlzaWNzCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIGlzTG93SGVhbHRoID0gaHVtYW5vaWQuSGVhbHRoIDw9IDIgCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNSYWdkb2xsZWQgYW5kIGlzTG93SGVhbHRoKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFBsYXllci5DaGFyYWN0ZXI6U2V0UHJpbWFyeVBhcnRDRnJhbWUoQ0ZyYW1lLm5ldyg1MjUuNTcxMTY2OTkyMTg3NSwgMTAuNjc1OTE4NTc5MTAxNTYyLCAtMjA3LjQyMjUzMTEyNzkyOTcpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCBibHVyID0gSW5zdGFuY2UubmV3KCJCbHVyRWZmZWN0IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsdXIuU2l6ZSA9IDE1CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibHVyLlBhcmVudCA9IGdhbWUuTGlnaHRpbmcKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiRGVicmlzIik6QWRkSXRlbShibHVyLCAwLjMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhaXQoMSkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kCn0pCgpsb2NhbCBTZWxmSGl0Ym94U2VjdGlvbiA9IFBsYXllclRhYjpBZGRTZWN0aW9uKHsKICAgIE5hbWUgPSAiU2VsZiBIaXRib3giCn0pCgpTZWxmSGl0Ym94U2VjdGlvbjpBZGRUb2dnbGUoewogICAgTmFtZSA9ICJFbmFibGUgU2VsZiBIaXRib3ggTW9kaWZpZXIiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgU2F2ZSA9IHRydWUsCiAgICBGbGFnID0gInNlbGZIaXRib3hFbmFibGVkIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgZ2V0Z2VudigpLlNlbGZIaXRib3hFbmFibGVkID0gVmFsdWUKICAgICAgICAKICAgICAgICBpZiBub3QgZ2V0Z2VudigpLlNlbGZIaXRib3hDb25uZWN0aW9uIHRoZW4KICAgICAgICAgICAgZ2V0Z2VudigpLlNlbGZIaXRib3hDb25uZWN0aW9uID0gZ2FtZTpHZXRTZXJ2aWNlKCdSdW5TZXJ2aWNlJykuUmVuZGVyU3RlcHBlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIGlmIGdldGdlbnYoKS5TZWxmSGl0Ym94RW5hYmxlZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgIGlmIGNoYXJhY3RlciBhbmQgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5TaXplID0gVmVjdG9yMy5uZXcoZ2V0Z2VudigpLlNlbGZIaXRib3hTaXplIG9yIDIsIGdldGdlbnYoKS5TZWxmSGl0Ym94U2l6ZSBvciAyLCBnZXRnZW52KCkuU2VsZkhpdGJveFNpemUgb3IgMikKICAgICAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuVHJhbnNwYXJlbmN5ID0gZ2V0Z2VudigpLlNlbGZIaXRib3hWaXNpYmxlIGFuZCAwLjcgb3IgMQogICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Ccmlja0NvbG9yID0gQnJpY2tDb2xvci5uZXcoIlJlYWxseSBibHVlIikKICAgICAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuTWF0ZXJpYWwgPSAiTmVvbiIKICAgICAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQ2FuQ29sbGlkZSA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgY2hhcmFjdGVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgIGlmIGNoYXJhY3RlciBhbmQgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5TaXplID0gVmVjdG9yMy5uZXcoMiwgMiwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuVHJhbnNwYXJlbmN5ID0gMQogICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Ccmlja0NvbG9yID0gQnJpY2tDb2xvci5uZXcoIk1lZGl1bSBzdG9uZSBncmV5IikKICAgICAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuTWF0ZXJpYWwgPSAiUGxhc3RpYyIKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKClNlbGZIaXRib3hTZWN0aW9uOkFkZFNsaWRlcih7CiAgICBOYW1lID0gIlNlbGYgSGl0Ym94IFNpemUiLAogICAgTWluID0gMiwKICAgIE1heCA9IDUwLAogICAgRGVmYXVsdCA9IDIsCiAgICBDb2xvciA9IENvbG9yMy5mcm9tUkdCKDcwLCAxMjAsIDI1NSksCiAgICBJbmNyZW1lbnQgPSAxLAogICAgU2F2ZSA9IHRydWUsCiAgICBGbGFnID0gInNlbGZIaXRib3hTaXplIiwKICAgIFZhbHVlTmFtZSA9ICJzdHVkcyIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGdldGdlbnYoKS5TZWxmSGl0Ym94U2l6ZSA9IFZhbHVlCiAgICBlbmQgICAgCn0pCgpTZWxmSGl0Ym94U2VjdGlvbjpBZGRUb2dnbGUoewogICAgTmFtZSA9ICJTZWxmIEhpdGJveCBWaXNpYmlsaXR5IiwKICAgIERlZmF1bHQgPSB0cnVlLAogICAgU2F2ZSA9IHRydWUsCiAgICBGbGFnID0gInNlbGZIaXRib3hWaXNpYmlsaXR5IiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgZ2V0Z2VudigpLlNlbGZIaXRib3hWaXNpYmxlID0gVmFsdWUKICAgIGVuZAp9KQoKbG9jYWwgVGVsZXBvcnRzVGFiID0gV2luZG93Ok1ha2VUYWIoewogICAgTmFtZSA9ICJUZWxlcG9ydHMiLAogICAgSWNvbiA9ICJyYnhhc3NldGlkOi8vNzczMzk2MDk4MSIsCiAgICBQcmVtaXVtT25seSA9IGZhbHNlCn0pCgpsb2NhbCBMb2NhdGlvbnNTZWN0aW9uID0gVGVsZXBvcnRzVGFiOkFkZFNlY3Rpb24oewogICAgTmFtZSA9ICJMb2NhdGlvbnMiCn0pCgpMb2NhdGlvbnNTZWN0aW9uOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIlRlbGVwb3J0IHRvIEtGQyIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBsb2NhbFBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGlmIGxvY2FsUGxheWVyLkNoYXJhY3RlciBhbmQgbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICBsb2NhbCBibHVyID0gSW5zdGFuY2UubmV3KCJCbHVyRWZmZWN0IikKICAgICAgICAgICAgYmx1ci5TaXplID0gMTUKICAgICAgICAgICAgYmx1ci5QYXJlbnQgPSBnYW1lLkxpZ2h0aW5nCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiRGVicmlzIik6QWRkSXRlbShibHVyLCAwLjMpCiAgICAgICAgICAgIAogICAgICAgICAgICBsb2NhbFBsYXllci5DaGFyYWN0ZXI6U2V0UHJpbWFyeVBhcnRDRnJhbWUoQ0ZyYW1lLm5ldyg0Ny40NjQyNjM5MTYwMTU2MjUsIDExLjAwMDI0MjIzMzI3NjM2NywgLTkzLjM1ODgyNTY4MzU5Mzc1KSkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKTG9jYXRpb25zU2VjdGlvbjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJUZWxlcG9ydCB0byBGbGFtZXRocm93ZXIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgbG9jYWxQbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBpZiBsb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIGxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICAgICAgbG9jYWwgYmx1ciA9IEluc3RhbmNlLm5ldygiQmx1ckVmZmVjdCIpCiAgICAgICAgICAgIGJsdXIuU2l6ZSA9IDE1CiAgICAgICAgICAgIGJsdXIuUGFyZW50ID0gZ2FtZS5MaWdodGluZwogICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIkRlYnJpcyIpOkFkZEl0ZW0oYmx1ciwgMC4zKQogICAgICAgICAgICAKICAgICAgICAgICAgbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOlNldFByaW1hcnlQYXJ0Q0ZyYW1lKENGcmFtZS5uZXcoNzkuMDMwNjMyMDE5MDQyOTcsIDEyLjE4MzkxNTEzODI0NDYyOSwgMTQ2LjE1MzQ3MjkwMDM5MDYyKSkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKTG9jYXRpb25zU2VjdGlvbjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJUZWxlcG9ydCB0byBCYWRkaWVzIEJvdXRpcXVlIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIGxvY2FsUGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgaWYgbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIGFuZCBsb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgIGxvY2FsIGJsdXIgPSBJbnN0YW5jZS5uZXcoIkJsdXJFZmZlY3QiKQogICAgICAgICAgICBibHVyLlNpemUgPSAxNQogICAgICAgICAgICBibHVyLlBhcmVudCA9IGdhbWUuTGlnaHRpbmcKICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJEZWJyaXMiKTpBZGRJdGVtKGJsdXIsIDAuMykKICAgICAgICAgICAgCiAgICAgICAgICAgIGxvY2FsUGxheWVyLkNoYXJhY3RlcjpTZXRQcmltYXJ5UGFydENGcmFtZShDRnJhbWUubmV3KDM5Ny40MTM2NjU3NzE0ODQ0LCA5LjM3Njc4NjIzMTk5NDYyOSwgLTEwNC44NTQ4NzM2NTcyMjY1NikpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCkxvY2F0aW9uc1NlY3Rpb246QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiVGVsZXBvcnQgdG8gRnJ5aW5nIFBhbiIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBsb2NhbFBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGlmIGxvY2FsUGxheWVyLkNoYXJhY3RlciBhbmQgbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICBsb2NhbCBibHVyID0gSW5zdGFuY2UubmV3KCJCbHVyRWZmZWN0IikKICAgICAgICAgICAgYmx1ci5TaXplID0gMTUKICAgICAgICAgICAgYmx1ci5QYXJlbnQgPSBnYW1lLkxpZ2h0aW5nCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiRGVicmlzIik6QWRkSXRlbShibHVyLCAwLjMpCiAgICAgICAgICAgIAogICAgICAgICAgICBsb2NhbFBsYXllci5DaGFyYWN0ZXI6U2V0UHJpbWFyeVBhcnRDRnJhbWUoQ0ZyYW1lLm5ldyg0MTAuMTA0OTQ5OTUxMTcxOSwgOS4zNzY3ODYyMzE5OTQ2MjksIC0xNzYuMTcxMzg2NzE4NzUpKQogICAgICAgIGVuZAogICAgZW5kCn0pCgpMb2NhdGlvbnNTZWN0aW9uOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIlRlbGVwb3J0IHRvIFNhbG9uIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIGxvY2FsUGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgaWYgbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIGFuZCBsb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgIGxvY2FsIGJsdXIgPSBJbnN0YW5jZS5uZXcoIkJsdXJFZmZlY3QiKQogICAgICAgICAgICBibHVyLlNpemUgPSAxNQogICAgICAgICAgICBibHVyLlBhcmVudCA9IGdhbWUuTGlnaHRpbmcKICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJEZWJyaXMiKTpBZGRJdGVtKGJsdXIsIDAuMykKICAgICAgICAgICAgCiAgICAgICAgICAgIGxvY2FsUGxheWVyLkNoYXJhY3RlcjpTZXRQcmltYXJ5UGFydENGcmFtZShDRnJhbWUubmV3KDQ4My42MDE4MDY2NDA2MjUsIDEwLjc1MjUwNzIwOTc3NzgzMiwgLTI3OC4xOTMzODk4OTI1NzgxKSkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKTG9jYXRpb25zU2VjdGlvbjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJUZWxlcG9ydCB0byBIb3NwaXRhbCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBsb2NhbFBsYXllciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllcgogICAgICAgIGlmIGxvY2FsUGxheWVyLkNoYXJhY3RlciBhbmQgbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICBsb2NhbCBibHVyID0gSW5zdGFuY2UubmV3KCJCbHVyRWZmZWN0IikKICAgICAgICAgICAgYmx1ci5TaXplID0gMTUKICAgICAgICAgICAgYmx1ci5QYXJlbnQgPSBnYW1lLkxpZ2h0aW5nCiAgICAgICAgICAgIGdhbWU6R2V0U2VydmljZSgiRGVicmlzIik6QWRkSXRlbShibHVyLCAwLjMpCiAgICAgICAgICAgIAogICAgICAgICAgICBsb2NhbFBsYXllci5DaGFyYWN0ZXI6U2V0UHJpbWFyeVBhcnRDRnJhbWUoQ0ZyYW1lLm5ldyg1MDcuMjcxNjk3OTk4MDQ2OSwgMTAuNjc1OTE3NjI1NDI3MjQ2LCAtMTg1LjkyNjUxMzY3MTg3NSkpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCkxvY2F0aW9uc1NlY3Rpb246QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiVGVsZXBvcnQgdG8gUm9ja2V0IExhdW5jaGVyIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIGxvY2FsUGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgaWYgbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIGFuZCBsb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgIGxvY2FsIGJsdXIgPSBJbnN0YW5jZS5uZXcoIkJsdXJFZmZlY3QiKQogICAgICAgICAgICBibHVyLlNpemUgPSAxNQogICAgICAgICAgICBibHVyLlBhcmVudCA9IGdhbWUuTGlnaHRpbmcKICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJEZWJyaXMiKTpBZGRJdGVtKGJsdXIsIDAuMykKICAgICAgICAgICAgCiAgICAgICAgICAgIGxvY2FsUGxheWVyLkNoYXJhY3RlcjpTZXRQcmltYXJ5UGFydENGcmFtZShDRnJhbWUubmV3KDU3My4xMzcwODQ5NjA5Mzc1LCA5LjI2OTQwNjMxODY2NDU1LCAtMTAyLjk3NTM5NTIwMjYzNjcyKSkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKTG9jYXRpb25zU2VjdGlvbjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJUZWxlcG9ydCB0byBEZWFsZXJzaGlwIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIGxvY2FsUGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgaWYgbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIGFuZCBsb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgIGxvY2FsIGJsdXIgPSBJbnN0YW5jZS5uZXcoIkJsdXJFZmZlY3QiKQogICAgICAgICAgICBibHVyLlNpemUgPSAxNQogICAgICAgICAgICBibHVyLlBhcmVudCA9IGdhbWUuTGlnaHRpbmcKICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJEZWJyaXMiKTpBZGRJdGVtKGJsdXIsIDAuMykKICAgICAgICAgICAgCiAgICAgICAgICAgIGxvY2FsUGxheWVyLkNoYXJhY3RlcjpTZXRQcmltYXJ5UGFydENGcmFtZShDRnJhbWUubmV3KDU1OC4wODE0ODE5MzM1OTM4LCA5Ljc5NTI4MzMxNzU2NTkxOCwgMTcuNjkzNzYzNzMyOTEwMTU2KSkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKTG9jYXRpb25zU2VjdGlvbjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJUZWxlcG9ydCB0byBBZG9wdGlvbiBDZW50ZXIiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgbG9jYWxQbGF5ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIKICAgICAgICBpZiBsb2NhbFBsYXllci5DaGFyYWN0ZXIgYW5kIGxvY2FsUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICAgICAgbG9jYWwgYmx1ciA9IEluc3RhbmNlLm5ldygiQmx1ckVmZmVjdCIpCiAgICAgICAgICAgIGJsdXIuU2l6ZSA9IDE1CiAgICAgICAgICAgIGJsdXIuUGFyZW50ID0gZ2FtZS5MaWdodGluZwogICAgICAgICAgICBnYW1lOkdldFNlcnZpY2UoIkRlYnJpcyIpOkFkZEl0ZW0oYmx1ciwgMC4zKQogICAgICAgICAgICAKICAgICAgICAgICAgbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyOlNldFByaW1hcnlQYXJ0Q0ZyYW1lKENGcmFtZS5uZXcoMTg4Ljg0NzYxMDQ3MzYzMjgsIDkuNTEzNTAxMTY3Mjk3MzYzLCAzOTkuNDc5NzM2MzI4MTI1KSkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKTG9jYXRpb25zU2VjdGlvbjpBZGRCdXR0b24oewogICAgTmFtZSA9ICJUZWxlcG9ydCB0byBKYWlsIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIGxvY2FsUGxheWVyID0gZ2FtZS5QbGF5ZXJzLkxvY2FsUGxheWVyCiAgICAgICAgaWYgbG9jYWxQbGF5ZXIuQ2hhcmFjdGVyIGFuZCBsb2NhbFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSB0aGVuCiAgICAgICAgICAgIGxvY2FsIGJsdXIgPSBJbnN0YW5jZS5uZXcoIkJsdXJFZmZlY3QiKQogICAgICAgICAgICBibHVyLlNpemUgPSAxNQogICAgICAgICAgICBibHVyLlBhcmVudCA9IGdhbWUuTGlnaHRpbmcKICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJEZWJyaXMiKTpBZGRJdGVtKGJsdXIsIDAuMykKICAgICAgICAgICAgCiAgICAgICAgICAgIGxvY2FsUGxheWVyLkNoYXJhY3RlcjpTZXRQcmltYXJ5UGFydENGcmFtZShDRnJhbWUubmV3KC00MS4wODkwNjE3MzcwNjA1NSwgMTAuMjMxODAwMDc5MzQ1NzAzLCAzODcuMDY1NjQzMzEwNTQ2OSkpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCmxvY2FsIFNldHRpbmdzVGFiID0gV2luZG93Ok1ha2VUYWIoewogICAgTmFtZSA9ICJTZXR0aW5ncyIsCiAgICBJY29uID0gInJieGFzc2V0aWQ6Ly83NzM0MDUzNDk1IiwKICAgIFByZW1pdW1Pbmx5ID0gZmFsc2UKfSkKCmxvY2FsIENvbmZpZ1NlY3Rpb24gPSBTZXR0aW5nc1RhYjpBZGRTZWN0aW9uKHsKICAgIE5hbWUgPSAiQ29uZmlndXJhdGlvbiIKfSkKCkNvbmZpZ1NlY3Rpb246QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiUmVzZXQgQWxsIFNldHRpbmdzIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIC0tIFJlc2V0IGFsbCBzYXZlZCBmbGFncyB0byB0aGVpciBkZWZhdWx0IHZhbHVlcwogICAgICAgIE9yaW9uTGliOlJlc2V0QWxsKCkKICAgICAgICAKICAgICAgICAtLSBSZXNldCBhbGwgZ2xvYmFsIHZhcmlhYmxlcwogICAgICAgIGdldGdlbnYoKS5IaXRib3hFeHBhbmRlciA9IGZhbHNlCiAgICAgICAgZ2V0Z2VudigpLldoaXRlbGlzdGVkUGxheWVycyA9IHt9CiAgICAgICAgZ2V0Z2VudigpLkhpdGJveFZpc2liaWxpdHkgPSB0cnVlCiAgICAgICAgZ2V0Z2VudigpLktpbGxBdXJhID0gZmFsc2UKICAgICAgICBnZXRnZW52KCkuTVVJID0gZmFsc2UKICAgICAgICBnZXRnZW52KCkuQXV0b0dyYWJFbmFibGVkID0gZmFsc2UKICAgICAgICBnZXRnZW52KCkuRVNQRW5hYmxlZCA9IGZhbHNlCiAgICAgICAgZ2V0Z2VudigpLkJveEVTUCA9IGZhbHNlCiAgICAgICAgZ2V0Z2VudigpLlBsYXllckhpZ2hsaWdodCA9IGZhbHNlCiAgICAgICAgZ2V0Z2VudigpLk5hbWVFU1AgPSBmYWxzZQogICAgICAgIGdldGdlbnYoKS5IZWFsdGhCYXIgPSBmYWxzZQogICAgICAgIGdldGdlbnYoKS5UcmFjZXJzID0gZmFsc2UKICAgICAgICBnZXRnZW52KCkuRGlzdGFuY2VFU1AgPSBmYWxzZQogICAgICAgIGdldGdlbnYoKS5Ub29sRVNQID0gZmFsc2UKICAgICAgICBnZXRnZW52KCkuQXV0b1N0b21wID0gZmFsc2UKICAgICAgICBnZXRnZW52KCkuQW50aVJhZ2RvbGwgPSBmYWxzZQogICAgICAgIGdldGdlbnYoKS5BdXRvUmVzZXQgPSBmYWxzZQogICAgICAgIGdldGdlbnYoKS5SYWluYm93Q2hhcmFjdGVyID0gZmFsc2UKICAgICAgICBnZXRnZW52KCkuU3BpbkJvdCA9IGZhbHNlCiAgICAgICAgZ2V0Z2VudigpLkFmdGVySW1hZ2VzID0gZmFsc2UKICAgICAgICBnZXRnZW52KCkuQXV0b0hlYWxSYWdkb2xsID0gZmFsc2UKICAgICAgICAKICAgICAgICAtLSBSZXNldCBjaGFyYWN0ZXIgcHJvcGVydGllcwogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICBpZiBjaGFyYWN0ZXIgdGhlbgogICAgICAgICAgICBpZiBjaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkIikgdGhlbgogICAgICAgICAgICAgICAgY2hhcmFjdGVyLkh1bWFub2lkLldhbGtTcGVlZCA9IDE2CiAgICAgICAgICAgICAgICBjaGFyYWN0ZXIuSHVtYW5vaWQuSnVtcFBvd2VyID0gNTAKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIAogICAgICAgICAgICAtLSBSZXNldCBjaGFyYWN0ZXIgY29sb3JzCiAgICAgICAgICAgIGZvciBfLCBwYXJ0IGluIHBhaXJzKGNoYXJhY3RlcjpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgaWYgcGFydDpJc0EoIkJhc2VQYXJ0IikgdGhlbgogICAgICAgICAgICAgICAgICAgIHBhcnQuQ29sb3IgPSBDb2xvcjMubmV3KDEsIDEsIDEpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgLS0gUmVzZXQgaGl0Ym94ZXMKICAgICAgICBmb3IgXywgdiBpbiBuZXh0LCBnYW1lOkdldFNlcnZpY2UoJ1BsYXllcnMnKTpHZXRQbGF5ZXJzKCkgZG8KICAgICAgICAgICAgaWYgdi5OYW1lIH49IGdhbWU6R2V0U2VydmljZSgnUGxheWVycycpLkxvY2FsUGxheWVyLk5hbWUgdGhlbgogICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIGlmIHYuQ2hhcmFjdGVyIGFuZCB2LkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgdi5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5TaXplID0gVmVjdG9yMy5uZXcoMiwgMiwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgdi5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5UcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgICAgICAgICAgICAgICAgIHYuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuQnJpY2tDb2xvciA9IEJyaWNrQ29sb3IubmV3KCJNZWRpdW0gc3RvbmUgZ3JleSIpCiAgICAgICAgICAgICAgICAgICAgICAgIHYuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuTWF0ZXJpYWwgPSAiUGxhc3RpYyIKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgLS0gTm90aWZ5IHVzZXIKICAgICAgICBPcmlvbkxpYjpNYWtlTm90aWZpY2F0aW9uKHsKICAgICAgICAgICAgTmFtZSA9ICJTZXR0aW5ncyBSZXNldCIsCiAgICAgICAgICAgIENvbnRlbnQgPSAiQWxsIHNldHRpbmdzIGhhdmUgYmVlbiByZXNldCB0byBkZWZhdWx0IHZhbHVlcyIsCiAgICAgICAgICAgIEltYWdlID0gInJieGFzc2V0aWQ6Ly80NDgzMzQ1OTk4IiwKICAgICAgICAgICAgVGltZSA9IDUKICAgICAgICB9KQogICAgZW5kCn0pCgpDb25maWdTZWN0aW9uOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIlNhdmUgQ3VycmVudCBTZXR0aW5ncyIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBPcmlvbkxpYjpTYXZlU2V0dGluZ3MoKQogICAgICAgIAogICAgICAgIE9yaW9uTGliOk1ha2VOb3RpZmljYXRpb24oewogICAgICAgICAgICBOYW1lID0gIlNldHRpbmdzIFNhdmVkIiwKICAgICAgICAgICAgQ29udGVudCA9ICJZb3VyIGN1cnJlbnQgc2V0dGluZ3MgaGF2ZSBiZWVuIHNhdmVkIiwKICAgICAgICAgICAgSW1hZ2UgPSAicmJ4YXNzZXRpZDovLzQ0ODMzNDU5OTgiLAogICAgICAgICAgICBUaW1lID0gNQogICAgICAgIH0pCiAgICBlbmQKfSkKCmxvY2FsIFVJU2VjdGlvbiA9IFNldHRpbmdzVGFiOkFkZFNlY3Rpb24oewogICAgTmFtZSA9ICJVSSBTZXR0aW5ncyIKfSkKClVJU2VjdGlvbjpBZGRUb2dnbGUoewogICAgTmFtZSA9ICJVSSBTb3VuZHMiLAogICAgRGVmYXVsdCA9IHRydWUsCiAgICBTYXZlID0gdHJ1ZSwKICAgIEZsYWcgPSAidWlTb3VuZHMiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBPcmlvbkxpYi5TZXR0aW5ncy5VSS5Tb3VuZHMgPSBWYWx1ZQogICAgZW5kCn0pCgpVSVNlY3Rpb246QWRkS2V5YmluZCh7CiAgICBOYW1lID0gIlRvZ2dsZSBVSSIsCiAgICBEZWZhdWx0ID0gRW51bS5LZXlDb2RlLlJpZ2h0Q29udHJvbCwKICAgIEhvbGQgPSBmYWxzZSwKICAgIFNhdmUgPSB0cnVlLAogICAgRmxhZyA9ICJ0b2dnbGVVSSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBHVUkgPSBnYW1lOkdldFNlcnZpY2UoIkNvcmVHdWkiKTpGaW5kRmlyc3RDaGlsZCgiT3Jpb24iKQogICAgICAgIGlmIEdVSSB0aGVuCiAgICAgICAgICAgIEdVSS5FbmFibGVkID0gbm90IEdVSS5FbmFibGVkCiAgICAgICAgZW5kCiAgICBlbmQgICAgCn0pCgpVSVNlY3Rpb246QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiRGVzdHJveSBVSSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBPcmlvbkxpYjpEZXN0cm95KCkKICAgIGVuZCAgICAKfSkKCmxvY2FsIENyZWRpdHNUYWIgPSBXaW5kb3c6TWFrZVRhYih7CiAgICBOYW1lID0gIkNyZWRpdHMiLAogICAgSWNvbiA9ICJyYnhhc3NldGlkOi8vNzczNDExMDYwOCIsCiAgICBQcmVtaXVtT25seSA9IGZhbHNlCn0pCgpsb2NhbCBDcmVkaXRzU2VjdGlvbiA9IENyZWRpdHNUYWI6QWRkU2VjdGlvbih7CiAgICBOYW1lID0gIlNjcmlwdCBJbmZvcm1hdGlvbiIKfSkKCkNyZWRpdHNTZWN0aW9uOkFkZEJ1dHRvbih7CiAgICBOYW1lID0gIk1hZGUgYnkgQWtpbyIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICAtLSBEb2VzIG5vdGhpbmcKICAgIGVuZAp9KQoKQ3JlZGl0c1NlY3Rpb246QWRkQnV0dG9uKHsKICAgIE5hbWUgPSAiRm9yIHN1cHBvcnQgam9pbiBkaXNjb3JkLmdnL2ZsZWVkIiwgCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICAtLSBEb2VzIG5vdGhpbmcKICAgIGVuZAp9KQoKT3Jpb25MaWI6SW5pdCgpCgpnYW1lOkdldFNlcnZpY2UoIkNvcmVHdWkiKS5DaGlsZFJlbW92ZWQ6Q29ubmVjdChmdW5jdGlvbihjaGlsZCkKICAgIGlmIGNoaWxkLk5hbWUgPT0gIk9yaW9uIiB0aGVuCiAgICAgICAgaWYgZ2V0Z2VudigpLkdyYWJDb25uZWN0aW9uIHRoZW4KICAgICAgICAgICAgZ2V0Z2VudigpLkdyYWJDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQogICAgICAgIGVuZAogICAgICAgIGlmIF9HLkhpdGJveENvbm5lY3Rpb24gdGhlbgogICAgICAgICAgICBfRy5IaXRib3hDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQogICAgICAgIGVuZAogICAgICAgIGdldGdlbnYoKS5FU1BFbmFibGVkID0gZmFsc2UKICAgICAgICBnZXRnZW52KCkuQm94RVNQID0gZmFsc2UKICAgICAgICBnZXRnZW52KCkuSGl0Ym94RXhwYW5kZXIgPSBmYWxzZQogICAgICAgIGdldGdlbnYoKS5BdXRvR3JhYkVuYWJsZWQgPSBmYWxzZQogICAgICAgIGdldGdlbnYoKS5NVUkgPSBmYWxzZQogICAgICAgIF9HLkRpc2FibGVkID0gZmFsc2UKICAgICAgICAKICAgICAgICBmb3IgXywgdiBpbiBuZXh0LCBnYW1lOkdldFNlcnZpY2UoJ1BsYXllcnMnKTpHZXRQbGF5ZXJzKCkgZG8KICAgICAgICAgICAgaWYgdi5OYW1lIH49IGdhbWU6R2V0U2VydmljZSgnUGxheWVycycpLkxvY2FsUGxheWVyLk5hbWUgdGhlbgogICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHYuQ2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuU2l6ZSA9IFZlY3RvcjMubmV3KDIsIDIsIDEpCiAgICAgICAgICAgICAgICAgICAgdi5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5UcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgICAgICAgICAgICAgdi5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Ccmlja0NvbG9yID0gQnJpY2tDb2xvci5uZXcoIk1lZGl1bSBzdG9uZSBncmV5IikKICAgICAgICAgICAgICAgICAgICB2LkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0Lk1hdGVyaWFsID0gIlBsYXN0aWMiCiAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIGlmIGdldGdlbnYoKS5LaWxsQXVyYUNvbm5lY3Rpb24gdGhlbgogICAgICAgICAgICBnZXRnZW52KCkuS2lsbEF1cmFDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIGlmIGdldGdlbnYoKS5TdG9tcENvbm5lY3Rpb24gdGhlbgogICAgICAgICAgICBnZXRnZW52KCkuU3RvbXBDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQogICAgICAgIGVuZAogICAgICAgIGlmIGdldGdlbnYoKS5SYWdkb2xsQ29ubmVjdGlvbiB0aGVuCiAgICAgICAgICAgIGdldGdlbnYoKS5SYWdkb2xsQ29ubmVjdGlvbjpEaXNjb25uZWN0KCkKICAgICAgICBlbmQKICAgICAgICBpZiBnZXRnZW52KCkuUmVzZXRDb25uZWN0aW9uIHRoZW4KICAgICAgICAgICAgZ2V0Z2VudigpLlJlc2V0Q29ubmVjdGlvbjpEaXNjb25uZWN0KCkKICAgICAgICBlbmQKICAgICAgICAKICAgICAgICBnZXRnZW52KCkuV2hpdGVsaXN0ZWRQbGF5ZXJzID0ge30KICAgICAgICBnZXRnZW52KCkuQXV0b1N0b21wID0gZmFsc2UKICAgICAgICBnZXRnZW52KCkuQW50aVJhZ2RvbGwgPSBmYWxzZQogICAgICAgIGdldGdlbnYoKS5BdXRvUmVzZXQgPSBmYWxzZQogICAgICAgIAogICAgICAgIGdldGdlbnYoKS5IaXRib3hWaXNpYmlsaXR5ID0gdHJ1ZQogICAgICAgIGlmIF9HLkhpdGJveENvbm5lY3Rpb24gdGhlbgogICAgICAgICAgICBfRy5IaXRib3hDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIGZvciBfLCB2IGluIG5leHQsIGdhbWU6R2V0U2VydmljZSgnUGxheWVycycpOkdldFBsYXllcnMoKSBkbwogICAgICAgICAgICBpZiB2Lk5hbWUgfj0gZ2FtZTpHZXRTZXJ2aWNlKCdQbGF5ZXJzJykuTG9jYWxQbGF5ZXIuTmFtZSB0aGVuCiAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgaWYgdi5DaGFyYWN0ZXIgYW5kIHYuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICB2LkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlNpemUgPSBWZWN0b3IzLm5ldygyLCAyLCAxKQogICAgICAgICAgICAgICAgICAgICAgICB2LkNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0LlRyYW5zcGFyZW5jeSA9IDEKICAgICAgICAgICAgICAgICAgICAgICAgdi5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Ccmlja0NvbG9yID0gQnJpY2tDb2xvci5uZXcoIk1lZGl1bSBzdG9uZSBncmV5IikKICAgICAgICAgICAgICAgICAgICAgICAgdi5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5NYXRlcmlhbCA9ICJQbGFzdGljIgogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICAKICAgICAgICBpZiBnZXRnZW52KCkuUmFpbmJvd0Nvbm5lY3Rpb24gdGhlbgogICAgICAgICAgICBnZXRnZW52KCkuUmFpbmJvd0Nvbm5lY3Rpb246RGlzY29ubmVjdCgpCiAgICAgICAgZW5kCiAgICAgICAgaWYgZ2V0Z2VudigpLlNwaW5Db25uZWN0aW9uIHRoZW4KICAgICAgICAgICAgZ2V0Z2VudigpLlNwaW5Db25uZWN0aW9uOkRpc2Nvbm5lY3QoKQogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIGxvY2FsIGNoYXJhY3RlciA9IGdhbWUuUGxheWVycy5Mb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICBpZiBjaGFyYWN0ZXIgdGhlbgogICAgICAgICAgICBmb3IgXywgcGFydCBpbiBwYWlycyhjaGFyYWN0ZXI6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgIGlmIHBhcnQ6SXNBKCJCYXNlUGFydCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICBwYXJ0LkNvbG9yID0gQ29sb3IzLm5ldygxLCAxLCAxKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICAKICAgICAgICAgICAgaWYgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpIHRoZW4KICAgICAgICAgICAgICAgIGNoYXJhY3Rlci5IdW1hbm9pZC5XYWxrU3BlZWQgPSAxNgogICAgICAgICAgICAgICAgY2hhcmFjdGVyLkh1bWFub2lkLkp1bXBQb3dlciA9IDUwCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIGdldGdlbnYoKS5SYWluYm93Q2hhcmFjdGVyID0gZmFsc2UKICAgICAgICBnZXRnZW52KCkuU3BpbkJvdCA9IGZhbHNlCiAgICAgICAgCiAgICAgICAgaWYgZ2V0Z2VudigpLkFmdGVySW1hZ2VDb25uZWN0aW9uIHRoZW4KICAgICAgICAgICAgZ2V0Z2VudigpLkFmdGVySW1hZ2VDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIGZvciBfLCBpbWFnZSBpbiBwYWlycyh3b3Jrc3BhY2U6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgaWYgaW1hZ2UuTmFtZSA9PSAiQWZ0ZXJJbWFnZSIgdGhlbgogICAgICAgICAgICAgICAgaW1hZ2U6RGVzdHJveSgpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIGZvciBfLCBpbWFnZSBpbiBwYWlycyh3b3Jrc3BhY2UuQ3VycmVudENhbWVyYTpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBpZiBpbWFnZS5OYW1lID09ICJBZnRlckltYWdlIiB0aGVuCiAgICAgICAgICAgICAgICBpbWFnZTpEZXN0cm95KCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgZ2V0Z2VudigpLkFmdGVySW1hZ2VzID0gZmFsc2UKICAgICAgICAKICAgICAgICBpZiBnZXRnZW52KCkuU2VsZkhpdGJveENvbm5lY3Rpb24gdGhlbgogICAgICAgICAgICBnZXRnZW52KCkuU2VsZkhpdGJveENvbm5lY3Rpb246RGlzY29ubmVjdCgpCiAgICAgICAgICAgIAogICAgICAgICAgICBsb2NhbCBjaGFyYWN0ZXIgPSBnYW1lLlBsYXllcnMuTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIGlmIGNoYXJhY3RlciBhbmQgY2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICAgICAgY2hhcmFjdGVyLkh1bWFub2lkUm9vdFBhcnQuU2l6ZSA9IFZlY3RvcjMubmV3KDIsIDIsIDEpCiAgICAgICAgICAgICAgICBjaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5UcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgICAgICAgICBjaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydC5Ccmlja0NvbG9yID0gQnJpY2tDb2xvci5uZXcoIk1lZGl1bSBzdG9uZSBncmV5IikKICAgICAgICAgICAgICAgIGNoYXJhY3Rlci5IdW1hbm9pZFJvb3RQYXJ0Lk1hdGVyaWFsID0gIlBsYXN0aWMiCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCmVuZCkK
]]))()
